<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content=""width=device-width, intiial-scale="1.0">
        <title>User Profile</title>
        <link rel="stylesheet" href="styleconfirm.css">
       
    </head>
    <body onload = "preservationfunction()">
        <main>
            <div class = "display_page">
                <h1>View the User's Profile</h1>
                 
            
                <div class = "pfp-out" id = "image-output"></div>
                
                <div id="data"></div>
                
                <div class = "output">
                    <button id="btn" onclick = "window.open('form.html')" onclick = "newWindow.document.close()" >Create Another Submission</button>
                    <label for = "btn">Create Another Submission</label>
                </div>
            </div>
            
        </main>
        <script>
            const windowurl = window.location.href;
            const idspec = windowurl.substring(windowurl.lastIndexOf('=') + 1);
            var retrieveId = localStorage.getItem('idkey')
            const url = localStorage.getItem('my-image' + retrieveId);
            const img = new Image(180, 180);
            img.src = url; 
            img.id = "pfp-view";
           
                
                        
            const json = localStorage.getItem('form' + retrieveId);
            const obj = JSON.parse(json);
            
            function preservationfunction() {
                for (i = 0; i < localStorage.length; i++){
                    if (localStorage.key(i) == "form" + idspec){
                        for (key in obj) {
                            const markup = `
                        <div>
                            <span>${key}: ${obj[key]}</span> 
                        </div>
                        `;
                        document.getElementById('data').innerHTML += markup;   
                        } 
                    } else if (localStorage.key(i) == "my-image" + idspec) {
                        document.getElementById("image-output").appendChild(img);
                    }
                }

            }


    
        </script>
    </body>
</html>
